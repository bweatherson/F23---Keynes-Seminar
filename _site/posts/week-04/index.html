<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.340">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Brian Weatherson">
<meta name="dcterms.date" content="2023-09-25">

<title>Keynes Seminar, Fall 2023 - Week 4: Indifference</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
</style>


<script src="../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../">
<script src="../../site_libs/quarto-html/quarto.js"></script>
<script src="../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit"
  }
}</script>
<link rel="stylesheet" href="https://use.typekit.net/uzz2drx.css">

  <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

</head>

<body class="floating nav-fixed slimcontent">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg navbar-dark ">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container">
    <a class="navbar-brand" href="../../index.html">
    <span class="navbar-title">Keynes Seminar, Fall 2023</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item compact">
    <a class="nav-link" href="https://canvas.umich.edu/" rel="" target=""><i class="bi bi-mortarboard" role="img">
</i> 
 <span class="menu-text"></span></a>
  </li>  
</ul>
            <div class="quarto-navbar-tools">
</div>
          </div> <!-- /navcollapse -->
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<header id="title-block-header" class="quarto-title-block default toc-left page-columns page-full">
  <div class="quarto-title-banner page-columns page-full">
    <div class="quarto-title column-body">
      <h1 class="title">Week 4: Indifference</h1>
                                <div class="quarto-categories">
                <div class="quarto-category">weekly handout</div>
              </div>
                  </div>
  </div>
    
  
  <div class="quarto-title-meta">

      <div>
      <div class="quarto-title-meta-heading">Author</div>
      <div class="quarto-title-meta-contents">
               <p>Brian Weatherson </p>
            </div>
    </div>
      
      <div>
      <div class="quarto-title-meta-heading">Published</div>
      <div class="quarto-title-meta-contents">
        <p class="date">September 25, 2023</p>
      </div>
    </div>
    
      
    </div>
    
  <div>
    <div class="abstract">
      <div class="abstract-title">Abstract</div>
      Keynes discusses the Principle of Indifference, his new name for the best hope we have for getting numerical probabilities out of ignorance.
    </div>
  </div>
  
  </header><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal sidebar-navigation floating overflow-auto">
    <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#indifference" id="toc-indifference" class="nav-link active" data-scroll-target="#indifference">“Indifference”</a></li>
  <li><a href="#counterexamples-to-indifference" id="toc-counterexamples-to-indifference" class="nav-link" data-scroll-target="#counterexamples-to-indifference">Counterexamples to Indifference</a>
  <ul class="collapse">
  <li><a href="#one-that-isnt-there---the-cube-factory" id="toc-one-that-isnt-there---the-cube-factory" class="nav-link" data-scroll-target="#one-that-isnt-there---the-cube-factory">One that isn’t there - the cube factory</a></li>
  <li><a href="#three-book-colours" id="toc-three-book-colours" class="nav-link" data-scroll-target="#three-book-colours">Three Book Colours</a></li>
  <li><a href="#adding-a-detail" id="toc-adding-a-detail" class="nav-link" data-scroll-target="#adding-a-detail">Adding a Detail</a></li>
  <li><a href="#having-names-for-parts" id="toc-having-names-for-parts" class="nav-link" data-scroll-target="#having-names-for-parts">Having Names for Parts</a></li>
  <li><a href="#volume-and-density" id="toc-volume-and-density" class="nav-link" data-scroll-target="#volume-and-density">Volume and Density</a></li>
  <li><a href="#bertrands-chord-example" id="toc-bertrands-chord-example" class="nav-link" data-scroll-target="#bertrands-chord-example">Bertrand’s Chord Example</a></li>
  </ul></li>
  <li><a href="#magnitudes-and-learning" id="toc-magnitudes-and-learning" class="nav-link" data-scroll-target="#magnitudes-and-learning">Magnitudes and Learning</a></li>
  <li><a href="#general-irrelevance" id="toc-general-irrelevance" class="nav-link" data-scroll-target="#general-irrelevance">General Irrelevance</a></li>
  <li><a href="#keyness-positive-version-of-the-poi" id="toc-keyness-positive-version-of-the-poi" class="nav-link" data-scroll-target="#keyness-positive-version-of-the-poi">Keynes’s Positive Version of the PoI</a></li>
  </ul>
<div class="quarto-alternate-formats"><h2>Other Formats</h2><ul><li><a href="index.pdf"><i class="bi bi-file-pdf"></i>PDF</a></li></ul></div></nav>
</nav>
<div id="quarto-sidebar-glass" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar"><div class="quarto-margin-header"><div class="margin-header-item">
<p>&nbsp;</p>
</div></div>
    </div>
<!-- main -->
<main class="content quarto-banner-title-block page-columns page-full" id="quarto-document-content">




<section id="indifference" class="level1">
<h1>“Indifference”</h1>
<p>Every time I read this chapter I’m surprised again at learning Keynes is responsible for the name “The Principle of Indifference”. It has stuck so thoroughly. And it is so much better than “The Principle of Non-Sufficient Reason”, which would make everyone think we were about to get into PSR and Leibniz and the cosmological argument. Anyway, it’s a good name, for what may or may not be a good principle.</p>
<p>Remember that Keynes thinks it is a wide-open question whether an argument may even have a probability. So let <em>a</em> be some proposition wholly disconnected from <em>h</em>. Then even if we’d convinced ourselves that <em>a</em> / <em>h</em> couldn’t be any number other than 0.5, it doesn’t follow for Keynes that it is 0.5. It might just be non-numerical.</p>
</section>
<section id="counterexamples-to-indifference" class="level1 page-columns page-full">
<h1>Counterexamples to Indifference</h1>
<p>Keynes kind of goes to town on the PoI in paragraphs 4-9. There are two big things to note here, neither of which I think is always properly reflected in the secondary literature on this problem.</p>
<ol type="1">
<li>This whole discussion is an in-house argument among people who have broadly epistemic theories of probability. If your response to these examples is “We need to know more about the physical setup, or underlying facts, or …”, then that means you really don’t believe the epistemic theory of probability. That’s fine - it’s a controversial theory. But Keynes isn’t arguing with you here; he’s talking to his fellow epistemic theorists.</li>
<li>There are a <em>lot</em> of examples here. Don’t think that by finding some solution to one of them, you’ve found some general solution to the problems with indifference.</li>
</ol>
<section id="one-that-isnt-there---the-cube-factory" class="level2">
<h2 class="anchored" data-anchor-id="one-that-isnt-there---the-cube-factory">One that isn’t there - the cube factory</h2>
<p>The cube factory example that van Fraassen uses in <em>Laws and Symmetry</em> isn’t quite there in Keynes. A similar example is. Van Fraassen’s example is that we know a factory produces perfect cubes of side length at most 2cm. Given that knowledge, and nothing else, what is the probability that the next cube has a side length under 1cm? Related question. We know that a factory produces perfect cubes of volume at most 8cm<sup>3</sup>. Given that knowledge, and nothing else, what is the probability that the next cube has a volume under 1cm<sup>3</sup>? Uh oh, these are the same question, but PoI (Principle of Indifference) says they get different answers.</p>
<p>Keynes will have an example like this, but it’s really striking how much variety there is to his counterexamples. One rather often sees people try to resolve the cube factory problem and thereby conclude that they have somehow rescued some version of the PoI.</p>
</section>
<section id="three-book-colours" class="level2">
<h2 class="anchored" data-anchor-id="three-book-colours">Three Book Colours</h2>
<p>We know nothing about a book. What’s the probability that it (or I guess its cover) is red? What about blue? What about black? If PoI says that they are each 0.5, we get a contradiction given the background knowledge that nothing is red, blue, and black.</p>
<p>Small question: Are these contraries? Surely some covers are blue and red. Does getting clear on the nature of the claim make it more plausible that the PoI wouldn’t apply.</p>
</section>
<section id="adding-a-detail" class="level2">
<h2 class="anchored" data-anchor-id="adding-a-detail">Adding a Detail</h2>
<p>Assume we know nothing whatsoever about an object A. Consider the proposition <em>A is a book</em>. Since we know nothing about whether it is or isn’t a book, PoI says that its probability is 0.5. Now consider the proposition <em>A is a red book</em>. Since we know nothing about whether it is or isn’t a red book, PoI says that its probability is 0.5. Putting these together, we get that the probability that A is red, conditional on being a book, is 1. That’s absurd.</p>
</section>
<section id="having-names-for-parts" class="level2 page-columns page-full">
<h2 class="anchored" data-anchor-id="having-names-for-parts">Having Names for Parts</h2>
<div class="page-columns page-full"><p>We know nothing about the world other than that it contains people, each of whom inhabit a point, and that it has regions which have points in them and that Great Britain, France, the British Isles, and Ireland, are among those regions. B is one of the people in the world. By PoI, each of the following are equiprobable: <em>B is in France</em>, <em>B is in Great Britain</em>, <em>B is in Ireland</em>, <em>B is in the British Isles</em>. We then learn that the British Isles just are Great Britain plus Ireland.<a href="#fn1" class="footnote-ref" id="fnref1" role="doc-noteref"><sup>1</sup></a> Either the PoI leads to a contradiction here, or each of these has probability 0, or learning that a region has named parts tells us <em>a lot</em> about the probability of people being in it. None of these is particularly plausible.</p><div class="no-row-height column-margin column-container"><li id="fn1"><p><sup>1</sup>&nbsp;Did Keynes have to do last minute changes to this example after Irish independence?!</p></li></div></div>
</section>
<section id="volume-and-density" class="level2 page-columns page-full">
<h2 class="anchored" data-anchor-id="volume-and-density">Volume and Density</h2>
<div class="page-columns page-full"><p>This is the closest we get to the cube factory (and the one that Keynes most clearly attributes to someone else). Assume we know nothing about a substance except that it’s specific volume<a href="#fn2" class="footnote-ref" id="fnref2" role="doc-noteref"><sup>2</sup></a> is between 1 and 3. PoI suggests that the probability that the specific volume is between 1 and 2 is 0.5. Compare, we get a substance and no nothing except that its specific density<a href="#fn3" class="footnote-ref" id="fnref3" role="doc-noteref"><sup>3</sup></a> is between 1/3 and 1. By PoI the probability that the specific density is between 1/3 and 2/3 is 0.5. But this is inconsistent with what we say about volumes.</p><div class="no-row-height column-margin column-container"><li id="fn2"><p><sup>2</sup>&nbsp;i.e., the number of cubic meters occupied by 1kg of the stuff</p></li><li id="fn3"><p><sup>3</sup>&nbsp;i.e., the inverse of the specific volume; this is not a term in widespread usage these days</p></li></div></div>
<p>Keynes uses a similar example when worrying about averaging prices in his 1909 essay on Index Numbers. Should we average the dollars per unit, or the units per dollars, when finding out the average price of various things? He argues that there is no particular reason to prefer one to the other.</p>
</section>
<section id="bertrands-chord-example" class="level2">
<h2 class="anchored" data-anchor-id="bertrands-chord-example">Bertrand’s Chord Example</h2>
<p>I’m not going to try explaining this one here, but we possibly should talk through it in class. Again, it feels somewhat like the cube factory, but I’m not sure it is subject to the same objections. (I do think the sphere example is basically the same as the chord example, but I might be misunderstanding the geometry here, since I was never very good at solid geometry.)</p>
<p>The real point Keynes makes is at the end of paragraph 7 about <em>f</em>.</p>
</section>
</section>
<section id="magnitudes-and-learning" class="level1">
<h1>Magnitudes and Learning</h1>
<p>This is in a sense another one of the counterexamples to PoI, but I’ve separated it out because it has such dramatic consequences. Start with a simple case. There is an urn with two balls in it, and all we know is that each ball is black or white, but we do not know the distribution. What does the PoI tell us should be the probability distribution. It turns out there are two different answers here that seem equally plausible at first blush.</p>
<p>First answer. There are three possibilities:</p>
<ol type="1">
<li>Two black;</li>
<li>One black, one white;</li>
<li>Two white.</li>
</ol>
<p>Second answer. There are four possibilities:</p>
<ol type="1">
<li>The first is black, and the second is black.</li>
<li>The first is black, and the second is white.</li>
<li>The first is white, and the second is black.</li>
<li>The first is white, and the second is white.</li>
</ol>
<p>On the first way of thinking, the PoI says that the probability of an all white urn is 1/3; on the second way of thinking, the PoI says that the probability of an all white urn is 1/4. Keynes goes on to give a reason for thinking the second way is right, and I guess as far as it goes that seems fair.</p>
<p>But think about an example that isn’t obviously different in form to this one. There are <em>n</em> swans in the world, and all we know <em>a priori</em> is that swans are no colour other than black or white. What are the possibilities that PoI says we should be indifferent between. Again, two possibilities jump out.</p>
<p>The first says that we should be indifferent between the <em>n</em>+1 possibilities of the form, <em>There are no white swans</em>, <em>There is one white swan</em>, <em>There are two white swans</em>, etc. The second says that we should be indifferent over the 2<sup><em>n</em></sup> distribution of black-white over the different swans.</p>
<p>The second does seem in some ways more natural. But it has a shocking consequence. It makes inductive learning impossible. Consider all questions of the following form.</p>
<ul>
<li>Assume you start with the probability distribution recommended by the PoI, and learn that the first <em>k</em> swans are white. What, as a function of <em>k</em>, is the probability that the next swan is white?</li>
</ul>
<p>Answer, on the second model, is that it is 1/2 no matter what. That seems absurd, so either (a) the PoI is wrong, or (b) it has been misapplied here, or (c) learning does not go by conditionalisation.</p>
<p>I think this is a problem even for the weaker, heavily qualified, version of the PoI that Keynes ends up endorsing, and it really ends up being a problem for lots of versions of the PoI. It might be, as I once argued, that (c) is the villain here, so this isn’t actually a problem for PoI. But it’s a worry.</p>
</section>
<section id="general-irrelevance" class="level1">
<h1>General Irrelevance</h1>
<p>On page 60 Keynes makes a bad slip, and it’s going to have significant consequences for us down the line. He is asking when the addition of evidence <em>h</em><sub>1</sub> is irrelevant to <em>x</em>/<em>h</em>. He first gives the familiar contemporary answer: it’s when <em>x</em>/<em>h</em> = <em>x</em>/<em>hh</em><sub>1</sub>. But then he says something stronger.</p>
<blockquote class="blockquote">
<p><em>h</em><sub>1</sub> is irrelevant to x on evidence <em>h</em>, if there is no proposition, inferrible from <em>h</em><sub>1</sub><em>h</em> but not from <em>h</em>, such that its addition to evidence <em>h</em> affects the probability of <em>x</em>.</p>
</blockquote>
<p>And as I’m sure has been pointed out before (I think I learned it from Carnap’s <em>Logical Foundations of Probability</em>, but I’m not sure it was new there), this rules out too much. On this definition, practically will be irrelevant. The problem is that the disjunction <em>h</em><sub>1</sub> <span class="math inline">\(\vee\)</span> <em>x</em> is (typically) inferrable from <em>hh</em><sub>1</sub> but not from <em>h</em> alone and (almost always), <em>x</em>/<em>h</em> &lt; <em>x</em>/<em>h</em>(<em>h</em><sub>1</sub> <span class="math inline">\(\vee\)</span> <em>x</em>).</p>
<p>As I said, I think this is, and similar examples, are going to land Keynes in all sorts of hot water.</p>
<p>I said last week that the sets of probability function model is, I once argued, a pretty good formalisation of Keynes’s intuitions. This point is relevant to that idea, in a roundabout way. On the sets of probability functions approach, you really don’t get anything like Keynes’s general notion of irrelevance. But that’s a <em>good</em> thing, because we should want to be rid of it, and any part of his theory that relies on it. What parts are those? Well, that’s a question we’ll need to keep an eye on.</p>
<p>The points at the top of 61, which are nowadays commonplaces, are important observations. Irrelevance (in either Keynes’s defective strict sense, or our more familiar loose sense), is closed under negation, and is symmetric. These are sometimes useful things to remember.</p>
</section>
<section id="keyness-positive-version-of-the-poi" class="level1">
<h1>Keynes’s Positive Version of the PoI</h1>
<p>I really just have one point here, though I haven’t quite been able to figure out a way to turn this into a full objection. In his (heavily) restricted version of the PoI, Keynes has propositional schema do some fairly heavy lifting. At a somewhat impressionistic level, Keynes is getting what’s ultimately a syntactic tool to try to do a metaphysical task. One might think that the lesson of Goodman’s grue paradox is that syntactic tools are ultimately not up to performing metaphysical tasks. I haven’t (yet) been able to figure out a way to turn Goodman’s ideas into a counterexample to what Keynes says, but I suspect someone else may be able to.</p>


</section>


</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->



</body></html>