<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.4.470">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Brian Weatherson">
<meta name="dcterms.date" content="2023-09-25">

<title>Keynes Seminar, Fall 2023 - Week 4: Indifference</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
</style>


<script src="../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../">
<script src="../../site_libs/quarto-html/quarto.js"></script>
<script src="../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<link rel="stylesheet" href="https://use.typekit.net/uzz2drx.css">

  <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

</head>

<body class="floating nav-fixed slimcontent">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a class="navbar-brand" href="../../index.html">
    <span class="navbar-title">Keynes Seminar, Fall 2023</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item compact">
    <a class="nav-link" href="https://canvas.umich.edu/"> <i class="bi bi-mortarboard" role="img">
</i> 
<span class="menu-text"></span></a>
  </li>  
</ul>
          </div> <!-- /navcollapse -->
          <div class="quarto-navbar-tools">
</div>
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<header id="title-block-header" class="quarto-title-block default toc-left page-columns page-full">
  <div class="quarto-title-banner page-columns page-full">
    <div class="quarto-title column-body">
      <h1 class="title">Week 4: Indifference</h1>
                                <div class="quarto-categories">
                <div class="quarto-category">weekly handout</div>
              </div>
                  </div>
  </div>
    
  
  <div class="quarto-title-meta">

      <div>
      <div class="quarto-title-meta-heading">Author</div>
      <div class="quarto-title-meta-contents">
               <p>Brian Weatherson </p>
            </div>
    </div>
      
      <div>
      <div class="quarto-title-meta-heading">Published</div>
      <div class="quarto-title-meta-contents">
        <p class="date">September 25, 2023</p>
      </div>
    </div>
    
      
    </div>
    
  <div>
    <div class="abstract">
      <div class="block-title">Abstract</div>
      Keynes discusses the Principle of Indifference, his new name for the best hope we have for getting numerical probabilities out of ignorance.
    </div>
  </div>
  
  </header><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
    <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#logicality" id="toc-logicality" class="nav-link active" data-scroll-target="#logicality">Logicality</a></li>
  <li><a href="#indifference" id="toc-indifference" class="nav-link" data-scroll-target="#indifference">“Indifference”</a></li>
  <li><a href="#counterexamples-to-indifference" id="toc-counterexamples-to-indifference" class="nav-link" data-scroll-target="#counterexamples-to-indifference">Counterexamples to Indifference</a>
  <ul class="collapse">
  <li><a href="#one-that-isnt-there---the-cube-factory" id="toc-one-that-isnt-there---the-cube-factory" class="nav-link" data-scroll-target="#one-that-isnt-there---the-cube-factory">One that isn’t there - the cube factory</a></li>
  <li><a href="#three-book-colours" id="toc-three-book-colours" class="nav-link" data-scroll-target="#three-book-colours">Three Book Colours</a></li>
  <li><a href="#adding-a-detail" id="toc-adding-a-detail" class="nav-link" data-scroll-target="#adding-a-detail">Adding a Detail</a></li>
  <li><a href="#having-names-for-parts" id="toc-having-names-for-parts" class="nav-link" data-scroll-target="#having-names-for-parts">Having Names for Parts</a></li>
  <li><a href="#volume-and-density" id="toc-volume-and-density" class="nav-link" data-scroll-target="#volume-and-density">Volume and Density</a></li>
  <li><a href="#bertrands-chord-example" id="toc-bertrands-chord-example" class="nav-link" data-scroll-target="#bertrands-chord-example">Bertrand’s Chord Example</a></li>
  </ul></li>
  <li><a href="#magnitudes-and-learning" id="toc-magnitudes-and-learning" class="nav-link" data-scroll-target="#magnitudes-and-learning">Magnitudes and Learning</a></li>
  <li><a href="#general-irrelevance" id="toc-general-irrelevance" class="nav-link" data-scroll-target="#general-irrelevance">General Irrelevance</a></li>
  <li><a href="#keyness-positive-version-of-the-poi" id="toc-keyness-positive-version-of-the-poi" class="nav-link" data-scroll-target="#keyness-positive-version-of-the-poi">Keynes’s Positive Version of the PoI</a>
  <ul class="collapse">
  <li><a href="#countable-additivity" id="toc-countable-additivity" class="nav-link" data-scroll-target="#countable-additivity">Countable Additivity</a></li>
  <li><a href="#syntax-and-semantics" id="toc-syntax-and-semantics" class="nav-link" data-scroll-target="#syntax-and-semantics">Syntax and Semantics</a></li>
  <li><a href="#disjunctive-parts" id="toc-disjunctive-parts" class="nav-link" data-scroll-target="#disjunctive-parts">Disjunctive Parts</a></li>
  </ul></li>
  </ul>
<div class="quarto-alternate-formats"><h2>Other Formats</h2><ul><li><a href="index.pdf"><i class="bi bi-file-pdf"></i>PDF</a></li></ul></div></nav>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar"><div class="quarto-margin-header"><div class="margin-header-item">
<p>&nbsp;</p>
</div></div>
    </div>
<!-- main -->
<main class="content quarto-banner-title-block page-columns page-full" id="quarto-document-content">





<section id="logicality" class="level1 page-columns page-full">
<h1>Logicality</h1>
<p>First, a confession. Although I’ve talked about the <em>Treatise</em> a lot both here and in written work, before this class I’d never really sat down to read it from start to finish. I basically read it as a collection of somewhat connected papers, reading whatever chapter was relevant to my then interests. Relatedly, I always read it in light of how we now think about things, not ever really trying to get a sense of what it meant to Keynes, or in Keynes’s time.</p>
<p>Now that’s not entirely a bad way to do things. I think it’s fine to have a very instrumental approach to history of philosophy, reading it to see what it can tell us about things that are independently interesting. Indeed, that’s usually my view. But sometimes you can overdo it, and be too instrumentalist about how one reads. And that can lead to missing things that are, I think, somewhat interesting. On that note, a second attempt to get clear on what Keynes means by probabilities being <strong>logical</strong>.</p>
<p>There are four ways to understand an author when they say that their theory has some feature.</p>
<ol type="1">
<li>Look for their definition of the feature. That’s not much help here since Keynes I don’t think is ever particularly clear about what it is to be logical.</li>
<li>Look at common usage at the time of the term they use. That maybe would help, but I’m not going to have us sit through three volumes of <em>Principia Mathematica</em> to figure this out. I’ll leave that to more serious historians.</li>
<li>Look at the argument they give for the feature. This turns out not to help because the argument Keynes gives is really bad. He just argues that probabilities are necessary and a priori. And while that’s interesting, it really isn’t enough to be logical in any interesting sense.</li>
<li>Look at how they apply that feature. And here we might be getting on to something. Because the discussion at the end of chapter 4, and into chapter 5, suggests something about a stronger thing Keynes might have meant. And it is, I think, interesting enough to digress into.</li>
</ol>
<p>Chapter 4, and onto chapter 5, have an odd place in the history of philosophy. The first half of chapter 4 is the best place to find a clear early statement, in English, of the problems with Indifference. It’s a devastating tour de force of objections. But the second half does not do what you expect if you only know the first half. It doesn’t say “Indifference, begone!”. Rather, it says that it’s time to find a restricted version of Indifference that avoids the (many, many) problems, and that this restricted version will ultimately be the basis for all probability.</p>
<p>Why might that be relevant. Well, think about four properties that we expect a logical relation to have. To be concrete, let’s focus on what it means for a particular sentence to be a logical truth, like a particular substitution instance of Peirce’s Law: <span class="math inline">\(((p \rightarrow q) \rightarrow p) \rightarrow p\)</span>.</p>
<ol type="1">
<li><strong>Necessity:</strong> This sentence is true in all possible worlds.</li>
<li><strong>A Priori:</strong> It is knowable a priori that this sentence is true.</li>
<li><strong>Analyticity:</strong> This sentence is true in virtue of its meaning.<a href="#fn1" class="footnote-ref" id="fnref1" role="doc-noteref"><sup>1</sup></a></li>
<li><strong>Formal:</strong> This sentence is true (and perhaps necessarily, a priori true) in virtue of its form.</li>
</ol>
<div class="no-row-height column-margin column-container"><li id="fn1"><p><sup>1</sup>&nbsp;There is a connection here to Keynes defining probability as a relation between sets. There is an argument, perhaps due to Michael Dummett, that Peirce’s Law is not a logical truth because it isn’t true in virtue of its meaning. And the argument turns on identifying the meaning of <span class="math inline">\(\rightarrow\)</span> with its role in a deduction system where arguments have many premises but just one conclusion. If you allow multiple conclusions, Peirce’s Law is analytic. I can say much more about this if anyone’s interested, but it’s really a digression.</p></li></div><p>Now when Keynes introduces the idea that probability is logical, he only really talks about 1 and 2, and that’s why I was kvetching last week that we don’t get a lot here. And, I thought, we really need at least 3, and ideally 4. But we don’t get it. And, as we now know, we can’t get it. The argument for this has two steps. The first step is to identify 4 with the following constraint.</p>
<ol start="5" type="1">
<li><strong>Formal-New:</strong> Any sentence with the same form as this one is also true (and ideally also has 1, 2, and 3).</li>
</ol>
<p>The second step is to show that probability relations do not satisfy 5. That’s easy enough given some concepts that we have and Keynes did not have. Start with the following definitions.</p>
<ul>
<li>An emerald is grue iff it is (a) examined by some human and green, or (b) not examined by any human and blue.</li>
<li>Let <span class="math inline">\(h_1\)</span> be that lots of us have examined lots of emeralds in lots of places, and they’ve all been green.</li>
<li>Let <span class="math inline">\(h_2\)</span> be that lots of us have examined lots of emeralds in lots of places, and they’ve all been grue.</li>
<li>Let <span class="math inline">\(a_1\)</span> be that the next emerald a human examines will be green.</li>
<li>Let <span class="math inline">\(a_2\)</span> be that the next emerald a human examines will be grue.</li>
</ul>
<p>Now the problem for Keynes. First, <span class="math inline">\(a_1/h_1\)</span> is very high. Second, <span class="math inline">\(a_2/h_2\)</span> is very low. Third,<span class="math inline">\(a_2/h_2\)</span> has the same form as <span class="math inline">\(a_1/h_1\)</span>. Then we can reason.</p>
<ol type="1">
<li>Probability does not satisfy <strong>Formal-New</strong>.</li>
<li>Therefore, probability does not satisfy <strong>Formal</strong>.</li>
<li>Therefore, probability is not logical, contra Keynes.</li>
</ol>
<p>Now question, where would Keynes reject this reasoning? Maybe he wouldn’t, maybe he’d say that oops, hadn’t thought about that example, back to the drawing board. And look, that’s not an unreasonable guess; he really didn’t know about ‘grue’. But let’s see if we can do a little better.</p>
<p>When I was a student, and probably when any of you were students, there was no sharp distinction made between <strong>Formal</strong> and <strong>Formal-New</strong>. I think in the textbooks I used, <strong>Formal-New</strong> was just taken to be the translation of <strong>Formal</strong> into a mathematically precise language. But there are two important things to note about this. First, it really is a theory of how to understand 4. Second, it wasn’t (to the best of my knowledge) a theory in Keynes’s time.<a href="#fn2" class="footnote-ref" id="fnref2" role="doc-noteref"><sup>2</sup></a> What happens if we reject the analysis of <strong>Formal</strong> as <strong>Formal-New</strong>, and hence the step from 1 to 2 in the last argument?</p>
<div class="no-row-height column-margin column-container"><li id="fn2"><p><sup>2</sup>&nbsp;Again confession time: I haven’t read nearly enough of <em>Principia Mathematica</em> to be sure about this, but I’m pretty confident that it is from circa the 1930s.</p></li><li id="fn3"><p><sup>3</sup>&nbsp;You can read about both of them in Graham Priest’s quite incredible <em>Introduction to Non-Classical Logics</em>. He thinks they are pretty weird, which is something coming from <em>Graham Priest</em>, but he does carefully set them out.</p></li></div><p>There are some twentieth century precedents for this? Not, to be sure, one Keynes could possibly have known about, but there are precedents. In so-called positive free logic, the inference from <span class="math inline">\(Fa\)</span> to <span class="math inline">\(\exists x: Fx\)</span> is valid iff <span class="math inline">\(F\)</span> is ‘positive’. So you can infer from <em>Brian is Australian</em> to <em>There is an Australian</em>, but not from <em>Santa Claus is unreal</em> to <em>Something is unreal</em>. This is usually spelled out as a constraint on the possible interpretations of the predicates: <span class="math inline">\(F\)</span> is only allowed to designate some positive property, like <em>Australian</em> and unlike <em>unreal</em>. In some non-normal modal logics, if <span class="math inline">\(p\)</span> is a primitive sentence-letter, then <span class="math inline">\(\diamond p\)</span> is an axiom. Again, it’s important here to put constraints on what sentence letters can designate. You can’t have <span class="math inline">\(p\)</span> mean <span class="math inline">\(a \neq a\)</span>, for example. These are obscure logics (to put it mildly), but they are definitely logics.<a href="#fn3" class="footnote-ref" id="fnref3" role="doc-noteref"><sup>3</sup></a> Maybe some similarly restricted notion of ‘same form’ can rescue Keynes here. That actually seems plausible to me, but I want to try a more twenty-first century defense instead.</p>
<p>The understanding of <strong>Formal</strong> as <strong>Formal-New</strong> follows a very common twentieth century paradigm. We understand claims of the form <em>X is true in virtue of Y</em> as invariance claims: No variation in <em>X</em> without variation in <em>Y</em>. That’s what’s going on here. <strong>Formal</strong> is an in virtue of claim: Peirce’s Law is true (/necessary/a prior) in virtue of its form. <strong>Formal-New</strong> is an invariance claim: you can’t change the truth (/modal status/epistemic status) of an instance of Peirce’s Law without changing its form. Merely changing its non-formal elements (i.e., the meanings of <span class="math inline">\(p\)</span> and <span class="math inline">\(q\)</span>) won’t be enough. In the twentieth century, these understandings of ‘in virtue of’ claims as invariance claims were everywhere in metaphysics, theory of mind, logic, epistemology, and elsewhere.<a href="#fn4" class="footnote-ref" id="fnref4" role="doc-noteref"><sup>4</sup></a></p>
<div class="no-row-height column-margin column-container"><li id="fn4"><p><sup>4</sup>&nbsp;The invariance claims were usually taken to be necessary truths, but they need not be. Jerry Fodor’s asymmetric counterfactual dependence theory of mental content is an invariance theory where the invariance is contingent.</p></li></div><p>In the twenty-first century, there has been a huge, discipline wide, rejection of the equation of these two types of claims. This largely traces to work Kit Fine did in the early 2000s, though it didn’t really take hold until around 2009. It’s often thought that that the connection fails in both directions.</p>
<p>You can have invariance without the in virtue of claim being true. I’m Australian in virtue of being born in Australia. But it’s not true that: I’m Australian in virtue of God knowing that I was born in Australia. And that’s the case even if it’s necessary that God knows everything, and so there’s no variation in my nationality without variation in God’s knowledge of where I’m both.</p>
<p>And (I think, though not everyone agrees), you can have in virtue of claims being true without the invariance claim being true. Assume, as I think is right, that lying is wrong other things equal, but sometimes there are good reasons to lie. And assume that <em>x</em> lies in a situation where there was no good reason. Then I think this is simply true: <em>x</em> did something wrong, and it was wrong in virtue of being a lie. But I think this isn’t true: <em>x</em> did something wrong, and the moral status of <em>x</em>’s act couldn’t change without changing whether it was a lie. The last thing is false because if there were special circumstances, it would have been ok to lie.</p>
<p>I suspect the best way to interpret Keynes, the way that makes him say the most interesting and plausible things, is to similarly say that he rejects the understanding of <strong>Formal</strong> as an invariance claim. True instances of Indifference are true in virtue of their form. That does not mean that anything with the same form is also true, any more than saying that <em>x</em>’s action is wrong in virtue of lying means that all lies are wrong. What it does mean is that when you have a correct instance of Indifference, it’s the formal features of the claim that <em>explain</em> why it is true, and which <em>make</em> it true. (Compare: In normal circumstances, it’s that it’s a lie that explains why it is wrong, and which makes it wrong.)</p>
<p>I don’t mean to say this strategy will work. It certainly doesn’t do enough to save the details of Keynes’s theory, which we’ve known at least since Carnap’s <em>Logical Foundations of Probability</em> (1950) don’t work out. But maybe it saves the idea that if (a) there is a restricted formulation of Indifference that works and (b) all true probability claims are ultimately derivable from true instances of this restricted formulation, then (c) it would be fair to call the theory logical.</p>
</section>
<section id="indifference" class="level1">
<h1>“Indifference”</h1>
<p>Every time I read this chapter I’m surprised again at learning Keynes is responsible for the name “The Principle of Indifference”. It has stuck so thoroughly. And it is so much better than “The Principle of Non-Sufficient Reason”, which would make everyone think we were about to get into PSR and Leibniz and the cosmological argument. Anyway, it’s a good name, for what may or may not be a good principle.</p>
<p>Remember that Keynes thinks it is a wide-open question whether an argument may even have a probability. So let <em>a</em> be some proposition wholly disconnected from <em>h</em>. Then even if we’d convinced ourselves that <em>a</em> / <em>h</em> couldn’t be any number other than 0.5, it doesn’t follow for Keynes that it is 0.5. It might just be non-numerical.</p>
</section>
<section id="counterexamples-to-indifference" class="level1 page-columns page-full">
<h1>Counterexamples to Indifference</h1>
<p>Keynes kind of goes to town on the PoI in paragraphs 4-9. There are two big things to note here, neither of which I think is always properly reflected in the secondary literature on this problem.</p>
<ol type="1">
<li>This whole discussion is an in-house argument among people who have broadly epistemic theories of probability. If your response to these examples is “We need to know more about the physical setup, or underlying facts, or …”, then that means you really don’t believe the epistemic theory of probability. That’s fine - it’s a controversial theory. But Keynes isn’t arguing with you here; he’s talking to his fellow epistemic theorists.</li>
<li>There are a <em>lot</em> of examples here. Don’t think that by finding some solution to one of them, you’ve found some general solution to the problems with indifference.</li>
</ol>
<section id="one-that-isnt-there---the-cube-factory" class="level2">
<h2 class="anchored" data-anchor-id="one-that-isnt-there---the-cube-factory">One that isn’t there - the cube factory</h2>
<p>The cube factory example that van Fraassen uses in <em>Laws and Symmetry</em> isn’t quite there in Keynes. A similar example is. Van Fraassen’s example is that we know a factory produces perfect cubes of side length at most 2cm. Given that knowledge, and nothing else, what is the probability that the next cube has a side length under 1cm? Related question. We know that a factory produces perfect cubes of volume at most 8cm<sup>3</sup>. Given that knowledge, and nothing else, what is the probability that the next cube has a volume under 1cm<sup>3</sup>? Uh oh, these are the same question, but PoI (Principle of Indifference) says they get different answers.</p>
<p>Keynes will have an example like this, but it’s really striking how much variety there is to his counterexamples. One rather often sees people try to resolve the cube factory problem and thereby conclude that they have somehow rescued some version of the PoI.</p>
</section>
<section id="three-book-colours" class="level2">
<h2 class="anchored" data-anchor-id="three-book-colours">Three Book Colours</h2>
<p>We know nothing about a book. What’s the probability that it (or I guess its cover) is red? What about blue? What about black? If PoI says that they are each 0.5, we get a contradiction given the background knowledge that nothing is red, blue, and black.</p>
<p>Small question: Are these contraries? Surely some covers are blue and red. Does getting clear on the nature of the claim make it more plausible that the PoI wouldn’t apply.</p>
</section>
<section id="adding-a-detail" class="level2">
<h2 class="anchored" data-anchor-id="adding-a-detail">Adding a Detail</h2>
<p>Assume we know nothing whatsoever about an object A. Consider the proposition <em>A is a book</em>. Since we know nothing about whether it is or isn’t a book, PoI says that its probability is 0.5. Now consider the proposition <em>A is a red book</em>. Since we know nothing about whether it is or isn’t a red book, PoI says that its probability is 0.5. Putting these together, we get that the probability that A is red, conditional on being a book, is 1. That’s absurd.</p>
</section>
<section id="having-names-for-parts" class="level2 page-columns page-full">
<h2 class="anchored" data-anchor-id="having-names-for-parts">Having Names for Parts</h2>
<p>We know nothing about the world other than that it contains people, each of whom inhabit a point, and that it has regions which have points in them and that Great Britain, France, the British Isles, and Ireland, are among those regions. B is one of the people in the world. By PoI, each of the following are equiprobable: <em>B is in France</em>, <em>B is in Great Britain</em>, <em>B is in Ireland</em>, <em>B is in the British Isles</em>. We then learn that the British Isles just are Great Britain plus Ireland.<a href="#fn5" class="footnote-ref" id="fnref5" role="doc-noteref"><sup>5</sup></a> Either the PoI leads to a contradiction here, or each of these has probability 0, or learning that a region has named parts tells us <em>a lot</em> about the probability of people being in it. None of these is particularly plausible.</p>
<div class="no-row-height column-margin column-container"><li id="fn5"><p><sup>5</sup>&nbsp;Did Keynes have to do last minute changes to this example after Irish independence?!</p></li></div></section>
<section id="volume-and-density" class="level2 page-columns page-full">
<h2 class="anchored" data-anchor-id="volume-and-density">Volume and Density</h2>
<p>This is the closest we get to the cube factory (and the one that Keynes most clearly attributes to someone else). Assume we know nothing about a substance except that it’s specific volume<a href="#fn6" class="footnote-ref" id="fnref6" role="doc-noteref"><sup>6</sup></a> is between 1 and 3. PoI suggests that the probability that the specific volume is between 1 and 2 is 0.5. Compare, we get a substance and no nothing except that its specific density<a href="#fn7" class="footnote-ref" id="fnref7" role="doc-noteref"><sup>7</sup></a> is between 1/3 and 1. By PoI the probability that the specific density is between 1/3 and 2/3 is 0.5. But this is inconsistent with what we say about volumes.</p>
<div class="no-row-height column-margin column-container"><li id="fn6"><p><sup>6</sup>&nbsp;i.e., the number of cubic meters occupied by 1kg of the stuff</p></li><li id="fn7"><p><sup>7</sup>&nbsp;i.e., the inverse of the specific volume; this is not a term in widespread usage these days</p></li></div><p>Keynes uses a similar example when worrying about averaging prices in his 1909 essay on Index Numbers. Should we average the dollars per unit, or the units per dollars, when finding out the average price of various things? He argues that there is no particular reason to prefer one to the other.</p>
</section>
<section id="bertrands-chord-example" class="level2">
<h2 class="anchored" data-anchor-id="bertrands-chord-example">Bertrand’s Chord Example</h2>
<p>I’m not going to try explaining this one here, but we possibly should talk through it in class. Again, it feels somewhat like the cube factory, but I’m not sure it is subject to the same objections. (I do think the sphere example is basically the same as the chord example, but I might be misunderstanding the geometry here, since I was never very good at solid geometry.)</p>
<p>The real point Keynes makes is at the end of paragraph 7 about <em>f</em>. Given the intuitions behind the PoI, (a) any two equally sized ranges of a function should have equal probability, and (b) probability should be preserved under bijections. (E.g., the probability of the side length being between <span class="math inline">\(x\)</span> and <span class="math inline">\(y\)</span> just is the probability of the volume being between <span class="math inline">\(x^3\)</span> and <span class="math inline">\(y^3\)</span>. But given there are monotonic increasing functions that do not preserve ratios of ranges, this can’t work.</p>
</section>
</section>
<section id="magnitudes-and-learning" class="level1">
<h1>Magnitudes and Learning</h1>
<p>This is in a sense another one of the counterexamples to PoI, but I’ve separated it out because it has such dramatic consequences. Start with a simple case. There is an urn with two balls in it, and all we know is that each ball is black or white, but we do not know the distribution. What does the PoI tell us should be the probability distribution. It turns out there are two different answers here that seem equally plausible at first blush.</p>
<p>First answer. There are three possibilities:</p>
<ol type="1">
<li>Two black;</li>
<li>One black, one white;</li>
<li>Two white.</li>
</ol>
<p>Second answer. There are four possibilities:</p>
<ol type="1">
<li>The first is black, and the second is black.</li>
<li>The first is black, and the second is white.</li>
<li>The first is white, and the second is black.</li>
<li>The first is white, and the second is white.</li>
</ol>
<p>On the first way of thinking, the PoI says that the probability of an all white urn is 1/3; on the second way of thinking, the PoI says that the probability of an all white urn is 1/4. Keynes goes on to give a reason for thinking the second way is right, and I guess as far as it goes that seems fair.</p>
<p>But think about an example that isn’t obviously different in form to this one. There are <em>n</em> swans in the world, and all we know <em>a priori</em> is that swans are no colour other than black or white. What are the possibilities that PoI says we should be indifferent between. Again, two possibilities jump out.</p>
<p>The first says that we should be indifferent between the <em>n</em>+1 possibilities of the form, <em>There are no white swans</em>, <em>There is one white swan</em>, <em>There are two white swans</em>, etc. The second says that we should be indifferent over the 2<sup><em>n</em></sup> distribution of black-white over the different swans.</p>
<p>The second does seem in some ways more natural. But it has a shocking consequence. It makes inductive learning impossible. Consider all questions of the following form.</p>
<ul>
<li>Assume you start with the probability distribution recommended by the PoI, and learn that the first <em>k</em> swans are white. What, as a function of <em>k</em>, is the probability that the next swan is white?</li>
</ul>
<p>Answer, on the second model, is that it is 1/2 no matter what. That seems absurd, so either (a) the PoI is wrong, or (b) it has been misapplied here, or (c) learning does not go by conditionalisation.</p>
<p>I think this is a problem even for the weaker, heavily qualified, version of the PoI that Keynes ends up endorsing, and it really ends up being a problem for lots of versions of the PoI. It might be, as I once argued, that (c) is the villain here, so this isn’t actually a problem for PoI. But it’s a worry.</p>
</section>
<section id="general-irrelevance" class="level1 page-columns page-full">
<h1>General Irrelevance</h1>
<p>On page 60 Keynes makes a bad slip, and it’s going to have significant consequences for us down the line. He is asking when the addition of evidence <em>h</em><sub>1</sub> is irrelevant to <em>x</em>/<em>h</em>. He first gives the familiar contemporary answer: it’s when <em>x</em>/<em>h</em> = <em>x</em>/<em>hh</em><sub>1</sub>. But then he says something stronger.</p>
<blockquote class="blockquote">
<p><em>h</em><sub>1</sub> is irrelevant to x on evidence <em>h</em>, if there is no proposition, inferrable from <em>h</em><sub>1</sub><em>h</em> but not from <em>h</em>, such that its addition to evidence <em>h</em> affects the probability of <em>x</em>.</p>
</blockquote>
<p>And this rules out too much<a href="#fn8" class="footnote-ref" id="fnref8" role="doc-noteref"><sup>8</sup></a>. On this definition, practically will be irrelevant. The problem is that the disjunction <em>h</em><sub>1</sub> <span class="math inline">\(\vee\)</span> <em>x</em> is (typically) inferrable from <em>hh</em><sub>1</sub> but not from <em>h</em> alone and (almost always), <em>x</em>/<em>h</em> &lt; <em>x</em>/<em>h</em>(<em>h</em><sub>1</sub> <span class="math inline">\(\vee\)</span> <em>x</em>).</p>
<div class="no-row-height column-margin column-container"><li id="fn8"><p><sup>8</sup>&nbsp;Carnap, for instance, says this in <em>Logical Foundations of Probability.</em></p></li></div><p>As I said, I think this is, and similar examples, are going to land Keynes in all sorts of hot water. Some of the problems will come up later in this chapter.</p>
<p>I said last week that the sets of probability function model is, I once argued, a pretty good formalisation of Keynes’s intuitions. This point is relevant to that idea, in a roundabout way. On the sets of probability functions approach, you really don’t get anything like Keynes’s general notion of irrelevance. But that’s a <em>good</em> thing, because we should want to be rid of it, and any part of his theory that relies on it. What parts are those? Well, that’s a question we’ll need to keep an eye on.</p>
<p>The points at the top of 61, which are nowadays commonplaces, are important observations. Irrelevance (in either Keynes’s defective strict sense, or our more familiar loose sense), is closed under negation, and is symmetric. These are sometimes useful things to remember.</p>
</section>
<section id="keyness-positive-version-of-the-poi" class="level1 page-columns page-full">
<h1>Keynes’s Positive Version of the PoI</h1>
<p>After so many attacks on the PoI, it is somewhat surprising, to me at least, that Keynes ends the chapter by offering his own version of the PoI. It is very heavily qualified, as we’re about to see more qualified than Keynes realises, but it is a version of the PoI. When I got to this part there were two problems I expected to find, which in retrospect I’m not sure were there. But there’s a much bigger problem that relates to the previous point about irrelevance.</p>
<section id="countable-additivity" class="level2 page-columns page-full">
<h2 class="anchored" data-anchor-id="countable-additivity">Countable Additivity</h2>
<p>First, I thought that the PoI would lead to some kind of problem with countable additivity. Keynes is careful to say that he only intends the PoI to apply to finite cases. But it’s very hard to get a philosophical principle here that doesn’t lead to countable additivity violations. Here’s the basic idea.<a href="#fn9" class="footnote-ref" id="fnref9" role="doc-noteref"><sup>9</sup></a></p>
<div class="no-row-height column-margin column-container"><li id="fn9"><p><sup>9</sup>&nbsp;Jake Ross has a couple of papers on Sleeping Beauty, one in <em>Phil Review</em> and one in <em>Phil Studies</em> that make a similar point. And I make a similar complaint, less clearly, in my objection to Adam Elga’s version of the PoI in an old PPR paper.</p></li></div><p>The cash value of Keynes’s version of the PoI is the following idea. Let <span class="math inline">\(\phi(x)\)</span> be some propositional radical such that <span class="math inline">\(\exists x: x \in S \wedge \phi (x)\)</span> is known (and is more or less trivial) for some set <span class="math inline">\(S\)</span>, and so is <span class="math inline">\(\forall x \forall y (\phi(x) \wedge \phi(y)) \rightarrow x = y\)</span> is also trivial. In words, exactly one thing is <span class="math inline">\(\phi\)</span>, and it is in <span class="math inline">\(S\)</span>. And let the evidence <span class="math inline">\(h\)</span> be symmetric with respect to any two substitution instances <span class="math inline">\(\phi(a), \phi(b)\)</span>, at least where <span class="math inline">\(a, b \in S\)</span>. Then what Keynes really wants is that <span class="math inline">\(\phi(a)/h = \phi(b)/h\)</span>. And that sounds kind of plausible enough, perhaps even after everything that we’ve seen previously in chapters 3 and 4.</p>
<p>That principle works fine when <span class="math inline">\(S\)</span> is finite; the probability of any one thing being the <span class="math inline">\(\phi\)</span> is <span class="math inline">\(1/|S|\)</span>. And it works fine when <span class="math inline">\(S\)</span> is uncountably infinite. The probability of any one thing being the <span class="math inline">\(\phi\)</span> is 0, but that’s probably what we want. And you can’t deduce any annoying things about cube volumes or substance density from these 0 values.<a href="#fn10" class="footnote-ref" id="fnref10" role="doc-noteref"><sup>10</sup></a></p>
<div class="no-row-height column-margin column-container"><li id="fn10"><p><sup>10</sup>&nbsp;Does everyone understand why? Maybe we should pause over this if not.</p></li></div><p>But it very much does not work when <span class="math inline">\(S\)</span> is countably infinite. In that case we get that the probability of any one thing being the <span class="math inline">\(\phi\)</span> is 0, but the probability of one of these things being the <span class="math inline">\(\phi\)</span> is 1. So the probability of this countably infinite disjunction, i.e., the first one is the <span class="math inline">\(\phi\)</span>, or the second one is, or the third one is, or …, is not equal to the sum of the probability of the disjuncts.</p>
<p>Now it’s a <em>very big question</em> in the last 100 years of philosophy of probability whether countable additivity is a requirement. It’s somewhat disappointing that Keynes doesn’t really address it. Indeed, he just seems to treat the only salient division among sample spaces to be finite vs infinite, whereas the modern tendency is to treat the big division as finite vs countably infinite vs uncountably infinite. Plenty of people think that it’s obviously true that you can have an equiprobable distribution over a countable set, so finite additivity must fail. And there are other reasons people have had for rejecting countable additivity.<a href="#fn11" class="footnote-ref" id="fnref11" role="doc-noteref"><sup>11</sup></a> Still, I think countable additivity is a good constraint, and if the PoI violates it, all the worse for the PoI.<a href="#fn12" class="footnote-ref" id="fnref12" role="doc-noteref"><sup>12</sup></a></p>
<div class="no-row-height column-margin column-container"><li id="fn11"><p><sup>11</sup>&nbsp;Dmitri Gallow, formerly of this parish, just posted a note arguing against countable additivity on grounds that should appeal to a Keynesian, because it appeals to the idea that conditional distributions are primitive. I think it’s a variant on the idea that if X is a flat distribution over the reals in [0, 1], then conditionalising on the evidence that X is rational will give you a violation of countable additivity. But that’s simplifying Dmitri’s views a little bit I suspect.</p></li><li id="fn12"><p><sup>12</sup>&nbsp;If we have time, I’ll go over the conglomerability argument for countable additivity, and maybe why not everyone buys it.</p></li></div></section>
<section id="syntax-and-semantics" class="level2 page-columns page-full">
<h2 class="anchored" data-anchor-id="syntax-and-semantics">Syntax and Semantics</h2>
<p>Keynes’s version of the PoI makes heavy use of a <em>syntactic</em> constraint. It’s all about whether the competing claims, which are meant to be equiprobable, can be put into the form <span class="math inline">\(\phi(a), \phi(b)\)</span>. The contrast is with <em>semantic</em> constraints on indifference principles. Adam Elga, in his <a href="https://philpapers.org/rec/ELGDDE">Dr Evil paper</a>, has such a principle<a href="#fn13" class="footnote-ref" id="fnref13" role="doc-noteref"><sup>13</sup></a>. Two propositions are equiprobable iff there is the right kind of bijection between the sets of centred worlds the two propositions represent.<a href="#fn14" class="footnote-ref" id="fnref14" role="doc-noteref"><sup>14</sup></a> And it’s very natural nowadays to have semantic versions of these principles.</p>
<div class="no-row-height column-margin column-container"><li id="fn13"><p><sup>13</sup>&nbsp;The paper is called “Defeating Dr Evil with Self-Locating Belief”, and it’s in <em>Philosophy and Phenomenological Research.</em></p></li><li id="fn14"><p><sup>14</sup>&nbsp;There’s a bunch of jargon in that last sentence, and I’m more than happy to go over it. But if you don’t want to know the details, the big picture point I’m trying to make here is that Elga’s version doesn’t look at how the two propositions are textually represented, but at the ways in which they are made true.</p></li></div><p>The syntax/semantics split here recurs in a bunch of related fields. It is kind of the same as the debate between proof-theoretic and model-theoretic conceptions of validity in philosophy of logic. And it is kind of the same as the debate between syntactic and semantic conceptions of laws in philosophy of science. And there are probably debates in metaphysics that have the same structure; or, if not, it’s only because the semantic side so comprehensively won.</p>
<p>And outside of logic, the semantic side has basically been on a 75 year winning streak, for a fairly simple reason. A very widespread view (which I am definitely sympathetic to) is that syntactic approaches can’t help with anything to do with probability/epistemology because of the grue paradox. Maybe a syntactic approach with a restriction to a special subset of the language can work, but it would take some proving that it did work.<a href="#fn15" class="footnote-ref" id="fnref15" role="doc-noteref"><sup>15</sup></a></p>
<div class="no-row-height column-margin column-container"><li id="fn15"><p><sup>15</sup>&nbsp;This is related to the points I was making about logicality.</p></li></div><p>Keynes has a syntactic approach for a few reasons. One is that it’s the early 20th century, and nobody was using semantic approaches; everything was syntactic. Another was that the grue paradox hadn’t been discovered. And a third, perhaps most important, was that Keynes was really committed to the idea that he was extending <em>logic</em> here, and everyone (even the model theorists) agrees that logic has <em>something</em> to do with syntax.</p>
<p>Still, when I read this my first thought was, Ah, Keynes is bringing syntactic weapons to a semantic fight, and this is bound to fail. So I started trying to come up with grue-like counterexamples to his theory. And I didn’t quite find them. Because there’s a more fundamental problem with the view.</p>
</section>
<section id="disjunctive-parts" class="level2 page-columns page-full">
<h2 class="anchored" data-anchor-id="disjunctive-parts">Disjunctive Parts</h2>
<p>Let’s look a little more closely at precisely what Keynes says is the constraint on the PoI.<a href="#fn16" class="footnote-ref" id="fnref16" role="doc-noteref"><sup>16</sup></a></p>
<div class="no-row-height column-margin column-container"><li id="fn16"><p><sup>16</sup>&nbsp;Carnap, in <em>The Logical Foundations of Probability</em> is very critical of Keynes on just this point. He doesn’t quite have the example I’m giving below, but essentially the criticism I’m making here is in Carnap.</p></li></div><blockquote class="blockquote">
<p>The Principle of Indifference is applicable to the alternatives <span class="math inline">\(\phi(a)\)</span> and <span class="math inline">\(\phi(b)\)</span>, when the evidence <span class="math inline">\(h\)</span> is so constituted that, if <span class="math inline">\(f(a)\)</span> is an independent part of <span class="math inline">\(h\)</span> (see §14) which is relevant to <span class="math inline">\(\phi(a)\)</span>, and does not contain any independent parts which are irrelevant to <span class="math inline">\(\phi(a)\)</span>, then <span class="math inline">\(h\)</span> includes <span class="math inline">\(f(b)\)</span> also.</p>
</blockquote>
<p>What is an ‘independent part’? When we look back at 14, we find this.</p>
<blockquote class="blockquote">
<p>It will be convenient to define also two other phrases. <span class="math inline">\(h_1\)</span> and <span class="math inline">\(h_2\)</span> are independent and complementary parts of the evidence, if between them they make up <span class="math inline">\(h\)</span> and neither can be inferred from the other.</p>
</blockquote>
<p>But now we have a problem. For any <span class="math inline">\(h, \phi\)</span>, we can define an <span class="math inline">\(f\)</span> as follows</p>
<p><span class="math display">\[
f(x) =_{df} (h \vee \phi(a)) \wedge (h \rightarrow (a=x))
\]</span></p>
<p>If <span class="math inline">\(x=a\)</span> that is entailed by <span class="math inline">\(h\)</span>, and together with <span class="math inline">\(h \vee \neg \phi(a)\)</span> entails <span class="math inline">\(h\)</span>. So those two are complementary and independent, and hence <span class="math inline">\(f(a)\)</span> is an independent part of <span class="math inline">\(h\)</span>. But <span class="math inline">\(f(b)\)</span> is false given <span class="math inline">\(h\)</span>, so clearly not part of <span class="math inline">\(h\)</span>. So for any <span class="math inline">\(h, \phi, a, b\)</span> there will be an <span class="math inline">\(f\)</span> such that <span class="math inline">\(h\)</span> includes <span class="math inline">\(f(a)\)</span> and not <span class="math inline">\(f(b)\)</span>, and <span class="math inline">\(f(a)\)</span> is an independent part of <span class="math inline">\(h\)</span>.</p>
<p>Does <span class="math inline">\(f(a)\)</span> satisfy the other clause Keynes gives that it “does not contain any independent parts which are irrelevant to <span class="math inline">\(\phi(a)\)</span>”? I’m not sure. This has gone on long enough, and maybe I’ll leave that one as a question for the readers.</p>


</section>
</section>


</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    const typesetMath = (el) => {
      if (window.MathJax) {
        // MathJax Typeset
        window.MathJax.typeset([el]);
      } else if (window.katex) {
        // KaTeX Render
        var mathElements = el.getElementsByClassName("math");
        var macros = [];
        for (var i = 0; i < mathElements.length; i++) {
          var texText = mathElements[i].firstChild;
          if (mathElements[i].tagName == "SPAN") {
            window.katex.render(texText.data, mathElements[i], {
              displayMode: mathElements[i].classList.contains('display'),
              throwOnError: false,
              macros: macros,
              fleqn: false
            });
          }
        }
      }
    }
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        for (let i = 0; i < 2; i++) {
          container.appendChild(note.children[i].cloneNode(true));
        }
        typesetMath(container);
        return container.innerHTML
      } else {
        typesetMath(note);
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      typesetMath(note);
      return note.innerHTML;
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->




</body></html>